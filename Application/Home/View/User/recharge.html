<extend name="Public:base"/>
<block name="style">
    <style>
        .form-group{
            display: inline-block;
            width: 100%;
            margin-top: 15px;
        }
        .widget-body{
            display: inline-block;
            width: 100%;
            height: 450px;
        }
        .save_info{
            float: right;
            margin-right: 45%;
            margin-top: 7%;
        }
        .form_label{
            display: inline-block;
            max-width: 100%;
            margin-bottom: 0px;
            line-height: 34px;
        }
        .form_text{
            width: 18%;
            display: inline-block;
            /*float: left;*/
        }
        #remarks{
            margin: 0px;
            width: 40%;
            height: 104px;
        }
        .input-group{
            width: 18.5%;
            float: left;
        }
    </style>
    <script>
        var conversiorate = {$conversion['conversiorate']};
        function matrixing(that){
            $("#dollar").val(parseFloat(that*conversiorate).toFixed(2));
        }
    </script>
</block>
<block name="main">
    <div class="col-lg-12 col-sm-12 col-xs-12">
        <div class="widget flat">
            <div class="widget-header">
                <span class="widget-caption">填写信息</span>
            </div><!--Widget Header-->
            <div class="widget-body">
                <div class="form-group">
                    <label class="col-sm-2 control-label text-align-right form_label">
                        选择产品：
                        <span class="badge" data-container="body" data-titleclass="bordered-purple" data-class="dark" data-toggle="popover-hover" data-placement="bottom" data-content="交易品种不同，资金和风控不同。请确保交易品种无误">?</span>
                    </label>
                    <foreach name="product_list" item="vo" key="k" >
                        <label class="col-sm-2 control-label form_label" style="width: 12%;">
                            <input value="{$vo.id}" name="product" type="radio" class="colored-blue">
                            <span class="text"> {$vo.name}</span>
                            <span class="badge margin-left-10" data-container="body" data-titleclass="bordered-purple" data-class="dark" data-toggle="popover-hover" data-placement="bottom" data-content="{$vo.intro}">?</span>
                        </label>
                        <if condition="($k+1)%3 eq 0">
                            <br/>
                        </if>
                    </foreach>
                    <!--</select>-->
                </div>
                <div class="form-group">
                    <label for="money" class="col-sm-2 control-label text-align-right form_label">充值金额（元）：</label>
                    <!--<input type="number" min="0.01" onkeyup="matrixing(this.value);" placeholder="请输入充值金额" class="form-control form_text" name="money" id="money">-->
                    <div class="input-group">
                        <span class="input-group-addon">￥</span>
                        <input type="number" min="0.01" onkeyup="matrixing(this.value);" placeholder="请输入充值金额" class="form-control" name="money" id="money">
                    </div>
                    <big style="float: left; margin: 0px 10px;line-height: 34px;"> ≈ </big>
                    <!--<input type="number" disabled min="0.01" class="form-control form_text" id="dollar">-->
                    <div class="input-group">
                        <span class="input-group-addon">$</span>
                        <input type="number" disabled min="0.01" placeholder="换算成美金" class="form-control" id="dollar">
                    </div>
                </div>
                <!--<div class="form-group">-->
                    <!--<label for="dollar" class="col-sm-2 control-label text-align-right form_label">换算为美金为：</label>-->
                    <!--<input type="number" disabled min="0.01" class="form-control form_text" id="dollar">-->
                <!--</div>-->
                <div class="form-group">
                    <label for="remarks" class="col-sm-2 control-label text-align-right form_label">备注：</label>
                    <textarea style="resize: inherit;" id="remarks" maxlength="100" placeholder="请填写备注(100字符以内)"></textarea>
                </div>
                <div class="form-group no-margin">
                    <div class="checkbox">
                        <label for="remarks" class="col-sm-2 control-label text-align-right "></label>
                        <label>
                            <input id="consent_agreement" checked type="checkbox">
                            <span class="text">我已阅读并同意 <a target="_blank" href="{:U('User/agreement')}">《合作协议》</a></span>
                        </label>
                    </div>
                </div>
                <a class="btn btn-blue shiny save_info" to-url="{:U('User/prepaid_records')}" url="{:U('User/recharge_handle')}">充值</a>

                <div class="form-group">
                    <hr/>
                    <label for="remarks" class="col-sm-8 control-label margin-left-50">
                    <h3 style="line-height: 28px;">
                        操盘须知：
                    </h3>
                    <p style="line-height: 28px;">
                        &nbsp;&nbsp;&nbsp;&nbsp;1、所属期货公司合规合法，所有交易均有港交所交割单。
                    </p>
                    <p style="line-height: 28px;">
                        &nbsp;&nbsp;&nbsp;&nbsp;2、外盘交易由多方构成：港交所、期货公司、博易大师、易盛、信管家、互联网线路公司等。恒铭软件仅提供程序化自动交易软件和相关资金支持，恒铭软件不承担任何交易风险以及因不可抗拒因素引发的系统风险和非系统风险。
                    </p>
                    <p style="line-height: 28px;">
                        &nbsp;&nbsp;&nbsp;&nbsp;3、投资者务必评估自身的经济承受能力、风险控制能力、身体及心理承受能力，审慎决定是否参与交易。
                    </p>
                    <p>
                        &nbsp;&nbsp;&nbsp;&nbsp;4<span style="font-family:宋体">、如出入金统一汇率调整，未出金的账户资金将自动按照新的汇率折算。</span>
                    </p>
                    <p>
                        <br/>
                    </p>
                    </label>
                </div>

            </div><!--Widget Body-->
        </div><!--Widget-->
    </div>
    <input value="{$conversion['conversiorate']}" id="conversiorate" type="hidden" />
</block>
<block name="script">
    <script>
        $(function(){
            $('.save_info').click(function(){
                var product_id = $('input[name="product"]:checked').val();
                var money = $.trim($("#money").val());
                var remarks = $.trim($("#remarks").val());
                if(!product_id){
                    hint('warning','提示','请选择产品');
                    return;
                }
                if(money==''){
                    $("#money").focus();
                    hint('warning','提示','请输入充值金额');
                    return;
                }
                if(isNaN(money)||money<0.01){
                    $("#money").focus();
                    hint('warning','提示','金额输入不合法！');
                    return;
                }
                if(!$("#consent_agreement").is(':checked')){
                    hint('warning','提示','请您阅读并同意《合作协议》');
                    return;
                }
                var url = $(this).attr('url');
                var to_url = $(this).attr('to-url');
                $.post(
                    url,
                    {
                        product_id:product_id,
                        money:money,
                        remarks:remarks,
                    },function(data){
                        if(data['code']==0){
                            hint('success',data['msg'],data['data']);
                            setTimeout(function(){
                                window.location.href=to_url;
                            },1000)
                        }else if(data['code']==1){
                            hint('warning',data['msg'],data['data']);
                        }else if(data['code']==2){
                            hint('warning',data['msg'],data['data']);
                        }
                    }
                )
            })
        })
    </script>
</block>